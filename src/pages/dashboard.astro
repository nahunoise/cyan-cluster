---
import Layout from '../layouts/Layout.astro';
---
<Layout title="Dashboard | The Creation Society">
  <main id="dashboard-content" class="hidden max-w-4xl mx-auto px-6 py-12 text-creation-cream">
    <header class="flex justify-between items-center mb-12">
      <h1 class="text-4xl font-serif italic text-creation-gold">Dashboard</h1>
      <button id="logout" class="text-[10px] uppercase opacity-30 hover:opacity-100 border border-white/10 px-4 py-2 rounded-full">Cerrar Sesi칩n</button>
    </header>
    
    <div class="bg-white/[0.02] p-10 rounded-[2.5rem] border border-white/[0.05]">
      <p class="text-xl font-serif italic text-creation-gold/80 mb-2">Acceso Verificado.</p>
      <p class="text-white/60">Bienvenido al 치rea exclusiva de creadores.</p>
    </div>
  </main>
</Layout>

<script>
  import { supabase } from '../lib/supabase';

  async function protectPage() {
    const { data: { session } } = await supabase.auth.getSession();
    const content = document.getElementById('dashboard-content');

    if (!session) {
      // Si no hay sesi칩n real, al login de inmediato
      window.location.assign('/login');
    } else {
      // Solo si hay sesi칩n mostramos la web
      content?.classList.remove('hidden');
    }
  }

  document.getElementById('logout')?.addEventListener('click', async () => {
    await supabase.auth.signOut();
    window.location.href = '/login';
  });

  protectPage();
</script>